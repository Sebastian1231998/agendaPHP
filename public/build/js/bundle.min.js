let datos={nombre:"",empresa:"",telefono:""},Buscador=document.querySelector(".buscador"),numContacto=document.querySelector(".num-contacto"),params=new URLSearchParams(location.search),id=params.get("id");function eventListener(){validaFormulario(),eliminarRegistro(),buscador(),numeroContacto()}function eliminarRegistro(){document.querySelectorAll(".eliminar").forEach(e=>{e.addEventListener("click",eliminarBD)})}function eliminarBD(e){let t;e.preventDefault(),t="I"==e.target.tagName?e.target.parentElement:e.target,Swal.fire({title:"Â¿estas seguro?",text:"Estas a punto de eliminar de un contacto",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Borrar"}).then(e=>{if(e.isConfirmed){let e=new XMLHttpRequest,n="models/eliminar?id="+t.getAttribute("data-set");e.open("GET",n,!0),e.onload=function(){if(200==this.status){let n=JSON.parse(e.responseText);console.log(n),"eliminado"==n.respuesta&&(Swal.fire("Eliminado!","Tu contacto ha sido eliminado","success"),t.parentElement.parentElement.parentElement.remove(),numeroContacto())}},e.send()}})}function validaFormulario(){document.querySelectorAll("input[type='text']");let e=document.querySelector("#submit"),t=e.value;e.addEventListener("click",(function(e){e.preventDefault();let n={nombre:document.querySelector("#nombre").value,empresa:document.querySelector("#empresa").value,telefono:document.querySelector("#telefono").value};if(console.log(n),""==n.nombre||""==n.empresa||""==n.telefono)mensaje("Todos los campos son obligatorios","error");else{let{nombre:e,empresa:o,telefono:a}=n,r=new FormData;r.append("nombre",e),r.append("empresa",o),r.append("telefono",a),r.append("accion",t),"crear"==t?insertarBD(r):actualizarBD(r)}}))}function insertarBD(e){let t=new XMLHttpRequest;t.open("POST","models/contacto",!0),t.onload=function(){if(200==this.status){let e=JSON.parse(t.responseText);if(console.log(e),"correcto"==e.respuesta){let t=document.querySelector("#registro_contacto"),n=document.createElement("tr");n.innerHTML=`\n         \n         <td>${e.nombre}</td>\n         <td>${e.empresa}</td>\n         <td>${e.telefono}</td>\n         \n         `;let o=document.createElement("td"),a=document.createElement("div");a.classList.add("flex-icon");let r=document.createElement("a");r.href="models/actualizar?id="+e.id;let l=document.createElement("i");l.classList.add("fas","fa-pencil-alt");let c=document.createElement("a");c.classList.add("eliminar"),c.setAttribute("data-set",e.id),id=e.id;let i=document.createElement("i");i.classList.add("fas","fa-trash-alt"),r.appendChild(l),c.appendChild(i),a.appendChild(r),a.appendChild(c),o.appendChild(a),n.appendChild(o),t.appendChild(n),document.querySelector("form").reset(),mensaje("Se ha creado correctamente","exito"),eliminarRegistro(),numeroContacto()}}},t.send(e)}function actualizarBD(e){let t=new XMLHttpRequest;$url="actualizar?id="+id,t.open("POST",$url,!0),t.onload=function(){if(200==this.status){"actualizado"==JSON.parse(t.responseText).respuesta&&(mensaje("Se actualizado correctamente","exito"),setTimeout(()=>{location.href="../agenda"},2e3))}},t.send(e)}function mensaje(e,t){let n=document.querySelector("#form-contacto"),o=document.createElement("div");o.classList.add("mensaje",t);let a=document.createElement("div");a.classList.add("contenido-mensaje"),a.innerHTML=`<p>${e}</p>`,o.appendChild(a),n.appendChild(o),setTimeout(()=>{o.remove()},3e3)}function buscador(){Buscador.addEventListener("input",search)}function search(e){let t=new RegExp(e.target.value,"i");document.querySelectorAll("tbody tr").forEach(e=>{e.style.display="none",-1!=e.childNodes[1].textContent.replace(/\s/g," ").search(t)&&(e.style.display="table-row"),numeroContacto()})}function numeroContacto(){let e=document.querySelectorAll("tbody tr"),t=0;e.forEach(e=>{console.log(e.style.display),""!=e.style.display&&"table-row"!=e.style.display||t++}),numContacto.textContent=t}document.addEventListener("DOMContentLoaded",(function(){eventListener()}));
//# sourceMappingURL=bundle.js.map
