{"version":3,"sources":["app.js"],"names":["datos","nombre","empresa","telefono","Buscador","document","querySelector","numContacto","params","URLSearchParams","location","search","id","get","eventListener","validaFormulario","eliminarRegistro","buscador","numeroContacto","querySelectorAll","forEach","a","addEventListener","eliminarBD","e","elemento","preventDefault","target","tagName","parentElement","Swal","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","then","result","isConfirmed","xhttp","XMLHttpRequest","url","getAttribute","open","onload","this","status","respuesta","JSON","parse","responseText","console","log","remove","send","submit","accion","value","mensaje","contacto","FormData","append","insertarBD","actualizarBD","cuerpoTabla","tr","createElement","innerHTML","td","divIconos","classList","add","enlaceActualizar","href","iconoActualizar","enlaceEliminar","setAttribute","iconoEliminar","appendChild","reset","$url","setTimeout","texto","tipo","formContacto","divMensaje","cuerpoMensaje","exp","RegExp","registro","style","display","childNodes","textContent","replace","registros","total"],"mappings":"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","file":"bundle.js","sourcesContent":["let datos = {\r\n  nombre: \"\",\r\n  empresa: \"\",\r\n  telefono: \"\",\r\n};\r\nlet Buscador = document.querySelector('.buscador');\r\nlet numContacto = document.querySelector('.num-contacto');\r\nlet params = new URLSearchParams(location.search);\r\nlet id = params.get(\"id\");\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", function () {\r\n  eventListener();\r\n\r\n  \r\n  \r\n});\r\n\r\n\r\nfunction eventListener() {\r\n  validaFormulario();\r\n  eliminarRegistro();\r\n  buscador();\r\n  numeroContacto();\r\n}\r\n\r\nfunction eliminarRegistro() {\r\n  let iconEliminar = document.querySelectorAll(\".eliminar\");\r\n\r\n  iconEliminar.forEach((a) => {\r\n    a.addEventListener(\"click\", eliminarBD);\r\n });\r\n\r\n}\r\n\r\nfunction eliminarBD(e){\r\n\r\n  e.preventDefault();\r\n\r\n  let elemento;\r\n\r\n  if (e.target.tagName == \"I\") {\r\n    elemento = e.target.parentElement;\r\n  } else {\r\n    elemento = e.target;\r\n  }\r\n\r\n\r\n\r\n  Swal.fire({\r\n    title: \"Â¿estas seguro?\",\r\n    text: \"Estas a punto de eliminar de un contacto\",\r\n    icon: \"warning\",\r\n    showCancelButton: true,\r\n    confirmButtonColor: \"#3085d6\",\r\n    cancelButtonColor: \"#d33\",\r\n    confirmButtonText: \"Borrar\",\r\n  }).then((result) => {\r\n    if (result.isConfirmed) {\r\n      //crear el objeto\r\n      let xhttp = new XMLHttpRequest();\r\n     \r\n    \r\n      //abrir la conexion\r\n      let id = elemento.getAttribute('data-set');\r\n      let url = `models/eliminar?id=${id}`;\r\n      xhttp.open(\"GET\", url, true);\r\n      //obtener respuesta\r\n      xhttp.onload = function () {\r\n        if (this.status == 200) {\r\n          let respuesta = JSON.parse(xhttp.responseText);\r\n  \r\n          console.log(respuesta);\r\n           if(respuesta.respuesta == \"eliminado\"){\r\n\r\n\r\n        \r\n            Swal.fire(\r\n              'Eliminado!',\r\n              'Tu contacto ha sido eliminado',\r\n              'success'\r\n            );\r\n\r\n            elemento.parentElement.parentElement.parentElement.remove();\r\n           \r\n\r\n            numeroContacto();\r\n           }\r\n        }\r\n      }\r\n\r\n      xhttp.send();\r\n    }\r\n  })\r\n}\r\n\r\n\r\nfunction validaFormulario() {\r\n  let inputs = document.querySelectorAll(\"input[type='text']\");\r\n\r\n  let submit = document.querySelector(\"#submit\");\r\n  let accion = submit.value;\r\n  submit.addEventListener(\"click\", function (e) {\r\n    e.preventDefault();\r\n\r\n    let nombre = document.querySelector(\"#nombre\").value;\r\n    let empresa = document.querySelector(\"#empresa\").value;\r\n    let telefono = document.querySelector(\"#telefono\").value;\r\n\r\n    let datos = {\r\n      nombre,\r\n      empresa,\r\n      telefono,\r\n    };\r\n\r\n    console.log(datos);\r\n\r\n    if (datos.nombre == \"\" || datos.empresa == \"\" || datos.telefono == \"\") {\r\n      mensaje(\"Todos los campos son obligatorios\", \"error\");\r\n    } else {\r\n      let { nombre, empresa, telefono } = datos;\r\n\r\n      let contacto = new FormData();\r\n\r\n      contacto.append(\"nombre\", nombre);\r\n      contacto.append(\"empresa\", empresa);\r\n      contacto.append(\"telefono\", telefono);\r\n      contacto.append(\"accion\", accion);\r\n\r\n      if (accion == \"crear\") {\r\n        insertarBD(contacto);\r\n      } else {\r\n        actualizarBD(contacto);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nfunction insertarBD(contacto) {\r\n  //crear el objeto\r\n\r\n  let xhttp = new XMLHttpRequest();\r\n\r\n  //abrir la conexion\r\n\r\n  xhttp.open(\"POST\", \"models/contacto\", true);\r\n\r\n  //obtener respuesta\r\n\r\n  xhttp.onload = function () {\r\n    if (this.status == 200) {\r\n      let respuesta = JSON.parse(xhttp.responseText);\r\n\r\n      console.log(respuesta);\r\n\r\n      if (respuesta.respuesta == \"correcto\") {\r\n        let cuerpoTabla = document.querySelector(\"#registro_contacto\");\r\n        let tr = document.createElement(\"tr\");\r\n        tr.innerHTML = `\r\n         \r\n         <td>${respuesta.nombre}</td>\r\n         <td>${respuesta.empresa}</td>\r\n         <td>${respuesta.telefono}</td>\r\n         \r\n         `;\r\n\r\n        let td = document.createElement(\"td\");\r\n        let divIconos = document.createElement(\"div\");\r\n        divIconos.classList.add(\"flex-icon\");\r\n\r\n        let enlaceActualizar = document.createElement(\"a\");\r\n        enlaceActualizar.href = `models/actualizar?id=${respuesta.id}`;\r\n\r\n        let iconoActualizar = document.createElement(\"i\");\r\n        iconoActualizar.classList.add(\"fas\", \"fa-pencil-alt\");\r\n\r\n        let enlaceEliminar = document.createElement(\"a\");\r\n        enlaceEliminar.classList.add('eliminar');\r\n        enlaceEliminar.setAttribute('data-set', respuesta.id);\r\n\r\n        id = respuesta.id;\r\n\r\n        let iconoEliminar = document.createElement(\"i\");\r\n        iconoEliminar.classList.add(\"fas\", \"fa-trash-alt\");\r\n\r\n        enlaceActualizar.appendChild(iconoActualizar);\r\n        enlaceEliminar.appendChild(iconoEliminar);\r\n\r\n        divIconos.appendChild(enlaceActualizar);\r\n        divIconos.appendChild(enlaceEliminar);\r\n\r\n        td.appendChild(divIconos);\r\n\r\n        tr.appendChild(td);\r\n\r\n        cuerpoTabla.appendChild(tr);\r\n\r\n        document.querySelector('form').reset();\r\n\r\n        mensaje(\"Se ha creado correctamente\", \"exito\");\r\n\r\n        eliminarRegistro();\r\n\r\n        numeroContacto()\r\n      }\r\n    }\r\n  };\r\n\r\n  //enviar los datos\r\n  xhttp.send(contacto);\r\n}\r\n\r\nfunction actualizarBD(contacto) {\r\n  //crear el objeto\r\n\r\n  let xhttp = new XMLHttpRequest();\r\n\r\n  //abrir la conexion\r\n\r\n  $url = `actualizar?id=${id}`;\r\n\r\n  xhttp.open(\"POST\", $url, true);\r\n\r\n  //obtener respuesta\r\n\r\n  xhttp.onload = function () {\r\n    if (this.status == 200) {\r\n      let respuesta = JSON.parse(xhttp.responseText);\r\n\r\n      if (respuesta.respuesta == \"actualizado\") {\r\n        mensaje(\"Se actualizado correctamente\", \"exito\");\r\n        setTimeout(() => {\r\n          location.href = \"../agenda\";\r\n        }, 2000);\r\n      }\r\n    }\r\n  };\r\n\r\n  xhttp.send(contacto);\r\n}\r\n\r\nfunction mensaje(texto, tipo) {\r\n  let formContacto = document.querySelector(\"#form-contacto\");\r\n\r\n  let divMensaje = document.createElement(\"div\");\r\n  divMensaje.classList.add(\"mensaje\", tipo);\r\n\r\n  let cuerpoMensaje = document.createElement(\"div\");\r\n  cuerpoMensaje.classList.add(\"contenido-mensaje\");\r\n\r\n  cuerpoMensaje.innerHTML = `<p>${texto}</p>`;\r\n  divMensaje.appendChild(cuerpoMensaje);\r\n\r\n  formContacto.appendChild(divMensaje);\r\n\r\n  setTimeout(() => {\r\n    divMensaje.remove();\r\n  }, 3000);\r\n}\r\n\r\nfunction buscador(){\r\n\r\n  Buscador.addEventListener('input', search);\r\n\r\n}\r\n\r\nfunction search(e){\r\n\r\n  let exp = new RegExp(e.target.value , \"i\");\r\n  \r\n  let registros = document.querySelectorAll('tbody tr');\r\n\r\n  registros.forEach( registro =>{\r\n\r\n    registro.style.display = 'none';\r\n\r\n    if(registro.childNodes[1].textContent.replace(/\\s/g, \" \").search(exp) != -1 ){\r\n      registro.style.display = 'table-row';\r\n  \r\n    }\r\n    numeroContacto();\r\n  })\r\n\r\n}\r\n\r\n\r\nfunction numeroContacto(){\r\n\r\n  let registros = document.querySelectorAll('tbody tr');\r\n\r\n  let total = 0; \r\n  registros.forEach(registro =>{\r\n\r\n    console.log(registro.style.display )\r\n\r\n    if(registro.style.display == '' ||  registro.style.display == 'table-row' ){\r\n\r\n      total++;\r\n    }\r\n\r\n  })\r\n  numContacto.textContent = total;\r\n\r\n\r\n}"]}